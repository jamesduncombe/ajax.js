!function(t){"use strict";function n(t){return p(this,t),l(this,t),w(this),E(this),this}var e={URLENCODED:"application/x-www-form-urlencoded",JSON:"application/json"},o=function(){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}(),r=["GET","POST","PUT","HEAD","DELETE","OPTIONS","TRACE","CONNECT"],i=function(){var t=document.getElementsByName("csrf-token")[0];return"undefined"!=typeof t&&null!==t?t.content:null},u=function(){},a=function(t){return e[t.type]},s=function(t){var n=new XMLHttpRequest;return"withCredentials"in n?n.open(t.method,t.url,!0):"undefined"!=typeof XDomainRequest&&(n=new XDomainRequest,n.open(t.method,t.url)),n.timeout=t.timeout,n},d=function(t,n){n.addEventListener("timeout",t.onTimeout(n),!1),t.onStart(n),n.addEventListener("readystatechange",function(){4===this.readyState&&(200===this.status?t.onSuccess(this):t.onError(this),t.onFinish(this))},!1)},f=function(t){var n=[];for(var e in t)t.hasOwnProperty(e)&&n.push(e+"="+encodeURIComponent(t[e]));return n.join("&")},h=function(t){return"JSON"===t.type?JSON.stringify(t.data):f(t.data)},c=function(t,n){for(var e=t.headers,o=0;o<e.length;o++){var r=e[o];n.setRequestHeader(r.key,r.value)}},p=function(t,n){t.method=n.method||r[0],t.url=n.url,t.data=n.data||{},t.token=n.token||i(),t.timeout=n.timeout||0,t.type=n.type||o[0],t.headers=n.headers||[]},l=function(t,n){for(var e=["onSuccess","onError","onStart","onFinish","onTimeout"],o=0;o<e.length;o++){var r=e[o];t[r]=n[r]||u}},m=function(t){if("undefined"==typeof t)throw new Error("Ajax requires a url.")},y=function(t){if(-1===r.indexOf(t))throw new Error("Ajax method must be valid.")},v=function(t){if(-1===o.indexOf(t))throw new Error("Ajax content type must be valid.")},w=function(t){m(t.url),y(t.method),v(t.type)},E=function(t){t.headers.push({key:"Content-Type",value:a(t)}),t.token&&t.headers.push({key:"X-CSRF-Token",value:t.token})};n.request=function(t){return new n(t).send()},n.prototype.send=function(){var t=s(this);return c(this,t),d(this,t),t.send(h(this)),this};var O=window.define||null;"function"==typeof O&&O.amd?O("ajax",[],function(){return n}):t.Ajax=n}(this);
