!function(t){"use strict";function n(t){return l(this,t),p(this,t),E(this),T(this),this}var e={URLENCODED:"application/x-www-form-urlencoded",JSON:"application/json"},o=function(){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}(),r=["GET","POST","PUT","HEAD","DELETE","OPTIONS","TRACE","CONNECT"],i=function(){var t=document.getElementsByName("csrf-token")[0];return"undefined"!=typeof t&&null!==t?t.content:null},u=function(){},a=function(t){return e[t.type]},s=function(t){var n=null;if(window.XMLHttpRequest)n=new XMLHttpRequest;else if(window.ActiveXObject)try{n=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{n=new ActiveXObject("Microsoft.XMLHTTP")}catch(o){}}if(!n)throw new Error("Your browser is way too old.");return n.open(t.method,t.url,!0),n.timeout=t.timeout,n},c=function(t,n){n.ontimeout=t.onTimeout(n),t.onStart(n),n.onreadystatechange=function(){4===this.readyState&&(200===this.status?t.onSuccess(this):t.onError(this),t.onFinish(this))}},f=function(t){var n=[];for(var e in t)t.hasOwnProperty(e)&&n.push(e+"="+encodeURIComponent(t[e]));return n.join("&")},h=function(t){return"JSON"===t.type?JSON.stringify(t.data):f(t.data)},d=function(t,n){for(var e=t.headers,o=0;o<e.length;o++){var r=e[o];n.setRequestHeader(r.key,r.value)}},l=function(t,n){t.method=n.method||r[0],t.url=n.url,t.data=n.data||{},t.token=n.token||i(),t.timeout=n.timeout||0,t.type=n.type||o[0],t.headers=n.headers||[]},p=function(t,n){for(var e=["onSuccess","onError","onStart","onFinish","onTimeout"],o=0;o<e.length;o++){var r=e[o];t[r]=n[r]||u}},w=function(t){if("undefined"==typeof t)throw new Error("Ajax requires a url.")},y=function(t,n){for(var e=0;e<t.length;e++)if(t[e]===n)return!0;return!1},v=function(t){if(!y(r,t))throw new Error("Ajax method must be valid.")},m=function(t){if(!y(o,t))throw new Error("Ajax content type must be valid.")},E=function(t){w(t.url),v(t.method),m(t.type)},T=function(t){t.headers.push({key:"Content-Type",value:a(t)}),t.token&&t.headers.push({key:"X-CSRF-Token",value:t.token})};n.request=function(t){return new n(t).send()},n.prototype.send=function(){var t=s(this);return d(this,t),c(this,t),t.send(h(this)),this};var O=window.define||null;"function"==typeof O&&O.amd?O("ajax",[],function(){return n}):t.Ajax=n}(this);
