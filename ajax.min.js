!function(a){function b(a){if(this.method=a.method||"GET",this.url=a.url,this.data=a.data||{},this.token=a.token||f(),this.onSuccess=a.onSuccess||g,this.onError=a.onError||g,this.onStart=a.onStart||g,this.onFinish=a.onFinish||g,this.onTimeout=a.onTimeout||g,this.timeout=a.timeout||0,this.type=a.type||"URLENCODED","undefined"==typeof a.url)throw new Error("Ajax requires a url.");if(-1===e.indexOf(this.method))throw new Error("Ajax method must be valid.");if(-1===d.indexOf(this.type))throw new Error("Ajax content type must be valid.");return this}var c={JSON:"application/json",URLENCODED:"application/x-www-form-urlencoded"},d=function(){out=[];for(var a in c)out.push(a);return out}(),e=["GET","POST","PUT","HEAD","DELETE","OPTIONS","TRACE","CONNECT"],f=function(){var a=document.getElementsByName("csrf-token")[0];return"undefined"!==a&&null!=a?a.content:null},g=function(){},h=function(a){return c[a.type]},i=function(a){var b=new XMLHttpRequest;return"withCredentials"in b?b.open(a.method,a.url,!0):"undefined"!=typeof XDomainRequest&&(b=new XDomainRequest,b.open(a.method,a.url)),b.timeout=a.timeout,b.setRequestHeader("Content-type",h(a)),a.token&&b.setRequestHeader("X-CSRF-Token",a.token),b},j=function(a,b){b.addEventListener("timeout",a.onTimeout(b),!1),a.onStart(b),b.addEventListener("readystatechange",function(){4===this.readyState&&(200===this.status?a.onSuccess(this):a.onError(this),a.onFinish(this))},!1)},k=function(a){if("JSON"===a.type)return JSON.stringify(a.data);var b=[];for(var c in a.data){var d=a.data[c];b.push(c+"="+encodeURIComponent(d))}return b.join("&")};b.request=function(a){return new this(a).send()},b.prototype.send=function(){return xhr=i(this),j(this,xhr),xhr.send(k(this)),this},"function"==typeof define&&define.amd?define("ajax",[],function(){return b}):a.Ajax=b}(this);